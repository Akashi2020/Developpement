const { MessageEmbed } = require('discord.js');
const { ynInvitation } = require('../config.json')

module.exports.run = (client, message, args, member) => {
    if (ynInvitation == 1){

const { guild } = message;

guild.fetchInvites().then((invites) => {
  const inviteCounter = {}

  invites.forEach((invite) => {
    const { uses, inviter } = invite
    const { username } = inviter

    const name = `${username}`

    inviteCounter[name] = (inviteCounter[name] || 0) + uses
  })

  const sortedInvites = Object.keys(inviteCounter).sort(
    (a, b) => inviteCounter[b] - inviteCounter[a]
  )

  console.log(sortedInvites)

  sortedInvites.length = 1

  for (const invite of sortedInvites) {
    const count = inviteCounter[invite]
    let embed = new MessageEmbed()
              .setColor('F26A0C')
              .setDescription(`${message.author.username} a un total d'invitation de ${count} membre(s)`);
        message.channel.send(embed)
      }
    });
  }
};

module.exports.help = {
    name:"invite"
};
